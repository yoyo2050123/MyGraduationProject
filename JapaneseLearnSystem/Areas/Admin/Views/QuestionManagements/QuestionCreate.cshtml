@{
    ViewData["Title"] = "生成題目";
}

<h2>生成題目</h2>

<div class="form-group">
    <label for="count">輸入要生成的題目數量：</label>
    <input type="number" id="count" class="form-control" value="10" min="1" />
</div>
<button id="generateBtn" class="btn btn-primary mt-2">生成</button>

<hr />

<div id="resultArea">
    <!-- 生成結果會顯示在這裡 -->
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(function () {
            $("#generateBtn").click(function () {
                var count = $("#count").val();

                $.ajax({
                    url: '@Url.Action("GenerateQuestionsAjax", "QuestionManagements", new { area = "Admin" })',
                    type: 'POST',
                    data: { count: count },
                    success: function (response) {
                        if (response.success) {
                            var html = "<h4>已生成 " + response.generatedCount + " 題：</h4><ul>";
                            $.each(response.messages, function (i, msg) {
                                html += "<li>" + msg + "</li>";
                            });
                            html += "</ul>";
                            $("#resultArea").html(html);
                        } else {
                            $("#resultArea").html("<p class='text-danger'>生成失敗</p>");
                        }
                    },
                    error: function () {
                        $("#resultArea").html("<p class='text-danger'>發生錯誤</p>");
                    }
                });
            });
        });
    </script>
}
